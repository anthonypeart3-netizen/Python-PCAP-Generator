import pyshark
import time
import os
from datetime import datetime


INTERFACE = ''
SAVE_FOLDER = r'C\test'
CAPTURE_DURATION = 300


os.makedirs(SAVE_FOLDER, exist_ok=True)


pycap = True


while True:
   timestamp = datetime.now().strftime('%Y%m%d_%H%M%S')
   filename = os.path.join(SAVE_FOLDER, f'capture_{timestamp}.pcapng')


   print(f"Starting capture: {filename}")
   capture = pyshark.LiveCapture(interface=INTERFACE, output_file=filename)
   capture.sniff(timeout=CAPTURE_DURATION)
   print(f"Saved: {filename}")

